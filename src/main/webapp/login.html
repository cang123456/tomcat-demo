<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <title>用户登录</title>
    <style>
        .login-box { width: 300px; margin: 100px auto; text-align: center; }
        input { margin: 10px 0; padding: 8px; width: 200px; }
        button { padding: 8px 20px; background: #4285F4; color: white; border: none; cursor: pointer; }
        #msg { color: red; margin-top: 10px; }
    </style>
</head>
<body>
<div class="login-box">
    <h2>登录</h2>
    用户名：<input type="text" id="username" placeholder="请输入用户名"><br>
    密码：<input type="password" id="password" placeholder="请输入密码"><br>
    <button onclick="login()">登录</button>
    <div id="msg"></div> <!-- 用于显示登录结果（成功/失败） -->
</div>

<script>
    // 登录核心逻辑：通过AJAX发送请求到Tomcat的Servlet
    function login() {
        // 1. 获取用户输入
        // alert("hello");
        const username = document.getElementById("username").value;
        const password = document.getElementById("password").value;

        // 2. 验证输入不为空
        if (!username || !password) {
            document.getElementById("msg").innerText = "用户名或密码不能为空！";
            return;
        }

        // 3. 创建AJAX对象（兼容浏览器）
        // const xhr = new XMLHttpRequest() || new ActiveXObject("Microsoft.XMLHTTP");

        // 4. 配置请求（POST方式，请求路径为Servlet的URL）
        // 注意：路径格式为 "http://localhost:8080/项目名/Servlet映射名"

        // xhr.open("POST", "http://localhost:8081/LoginServlet", true);
        // xhr.open('POST', 'http://localhost:8081/LoginServlet', true);
        $.ajax({
            url: "http://localhost:8081/LoginServlet",
            type: "POST",
            contentType: "application/x-www-form-urlencoded; charset=UTF-8", // 设置请求编码
            data: { username: $("#username").val(), password: $("#password").val() },
            success: function(data) {
                console.log(data);
            },
            error: function(xhr, status, error) {
                console.log("Error: " + error);
            }
        });


        // 5. 设置请求头（POST请求需指定表单数据格式）
        // xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");

        // 6. 发送请求（携带用户名和密码参数）
        // xhr.send(`username=\${encodeURIComponent(username)}&password=\${encodeURIComponent(password)}`);
        // 先获取输入框的值
        // const username1 = document.getElementById("username").value;
        // const password1 = document.getElementById("password").value;

// 然后发送请求
//         xhr.send(`username=${encodeURIComponent(username1)}&password=${encodeURIComponent(password1)}`);
//
//         // 7. 监听后端响应
//         xhr.onreadystatechange = function() {
//             // 当请求完成且响应成功（readyState=4，status=200）
//             if (xhr.readyState === 4 && xhr.status === 200) {
//                 // 后端返回JSON字符串，解析为JS对象
//                 const result = JSON.parse(xhr.responseText);
//
//                 // 根据后端返回的success字段处理结果
//                 if (result.success) {
//                     document.getElementById("msg").style.color = "green";
//                     document.getElementById("msg").innerText = "登录成功！即将跳转...";
//                     // 登录成功后跳转首页（如index.html）
//                     setTimeout(() => window.location.href = "index.jsp", 1500);
//                 } else {
//                     document.getElementById("msg").innerText = result.msg; // 显示失败原因（如“用户名或密码错误”）
//                 }
//             }
//         };
    }
</script>
</body>
</html>